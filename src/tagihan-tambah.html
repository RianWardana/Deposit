<dom-module id="tagihan-tambah">
    <template>
        <style include="iron-flex iron-flex-alignment">
            paper-button {
                color: #FFAB00;
            }

            paper-checkbox {
                --paper-checkbox-checked-color: #4CAF50;
                --paper-checkbox-checked-ink-color: #4CAF50;
            }

            paper-fab {
                background-color: #4CAF50;
                position: fixed;
                right: 5%;
                bottom: 5%;
            }

            @media (max-height: 450px) {
                paper-dialog {
                    bottom: 0;
                }
            }

            paper-input[label="Nama"] { margin-right: 20px; }
        </style>

        <paper-dialog id="dialog" on-iron-overlay-closed="_dialogClosed">
            <h2>Tambah Pengeluaran</h2>
            <div class="horizontal layout">
                <paper-input list="daftar-pengeluaran" no-label-float label="Nama" value="{{nama}}" maxlength="64"></paper-input>
                <datalist id="daftar-pengeluaran">
                    <template is="dom-repeat" items="{{daftarNamaPengeluaran}}" as="item">
                        <option value="{{item}}">
                    </template>
                </datalist>
                <paper-input no-label-float type="number" value="{{jumlah}}" auto-validate pattern="[0-9]*" maxlength="8">
                    <div slot="prefix">Rp</div>
                </paper-input>
            </div>
            <paper-checkbox id="salinKeRekening">Salin ke rekening</paper-checkbox>
            <div class="buttons">
                <paper-button dialog-confirm>Batal</paper-button>
                <paper-button id="btnTambah" on-tap="tambah">Tambah</paper-button>
            </div>
        </paper-dialog>

        <paper-fab id="fab" icon="add" on-tap="fabClick"></paper-fab>
        <paper-toast id="toastKosong" text="Nama dan jumlah wajib diisi"></paper-toast>
    </template>



    <script>
        (function() {
            Polymer({
                is: 'tagihan-tambah',
                behaviors: [Polymer.NeonAnimationRunnerBehavior],
                properties: {
                    daftarNamaPengeluaran: {
                        type: Array,
                        value: [
                            "Makan",
                            "Minum",
                            "Go-Food",
                            "GrabFood",
                            "Transportasi",
                            "Go-Ride",
                            "Go-Car",
                            "Go-Jek Subs",
                            "GrabRide",
                            "GrabCar",
                            "Grab Subs",
                            "Sereal",
                            "Sabun",
                            "Parkir",
                            "e-Money"
                        ]
                    },

                    dataTambah: {
                        type: Object,
                        notify: true
                    },

                    nama: String,
                    jumlah: Number,

                    // animationConfig: {
                    //     value: function() {
                    //         return {
                    //             'entry': [
                    //                 {
                    //                     name: 'fade-in-animation',
                    //                     node: this.$.fab,
                    //                     timing: {duration: 300}
                    //                 }
                    //             ],
                    //             'exit': [
                    //                 {
                    //                     name: 'fade-out-animation',
                    //                     node: this.$.fab,
                    //                     timing: {duration: 300}
                    //                 }
                    //             ]
                    //         }
                    //     }
                    // }
                },

                listeners: {
                    'neon-animation-finish': '_animationFinished'
                },

                ready: function() {  
                    thisTagTambah = this;

                    thisTagTambah.$.dialog.animationConfig = {
                        'entry': [
                            {
                                name: 'fade-in-animation',
                                node: this.$.dialog,
                                timing: {duration: 300}
                            }
                        ],
                        'exit': [
                            {
                                name: 'fade-out-animation',
                                node: this.$.dialog,
                                timing: {duration: 300}
                            }
                        ]
                    }
                },

                tambah: function() {
                    if ((this.nama != "") && (this.jumlah != "")) { 
                        this.$.dialog.close();

                        this.dataTambah = {
                            nama: this.nama,
                            jumlah: this.jumlah
                        }

                        // Tambah ke rekening //
                        if (salinKeRekening.checked) {
                            thisRekDat.dataTambah = {
                                nama: this.nama,
                                debit: this.jumlah,
                                kredit: 0
                            }
                        }
                    } else {
                        this.$.toastKosong.open()
                    }
                },

                _dialogClosed: function() {
                    window.onresize = null
                    this.$.fab.style.display = 'block'
                    this.playAnimation('entry')
                },

                _animationFinished: function() {
                    if (this.$.dialog.opened) {
                        this.$.fab.style.display = 'none'
                    }
                },

                fabClick: function() {
                    this.playAnimation('exit')
                    this.nama = ""
                    this.jumlah = ""
                    // salinKeRekening.checked = false;
                    this.$.dialog.open()
                }
                
            });
        })();
    </script>
</dom-module>